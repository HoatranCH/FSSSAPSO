% bvib manual
% Tutorial: static analysis
% Units: m, kN
% Nodes=[NodID X Y Z]
lspan = 75;     
k1= 0.000007690150000e8;
k2= 0.142545717700000e11;    %kN/m
k3= 0.200000000000000e11;
k4= 0.000200000000000e11;
k5= 0.000200000000000e11;
k6= 0.181159827460000e11;
k7=0.197718966190000e11;
%}
dy = 0.0001;
%dy = 0.0001; %m, distance between nodes at a truss joint
yt=0;
yb=0;
b=0;
E=1.96E11;
Nodes= [1000,0.00,0.00,0.00;
1002,9.30,0.00,0.00
1102,9.30,0.00,dy
1004,18.70,0.00,0.00
1104,18.70,0.00,dy
1204,18.70-dy,0.00,0.00+dy
1006,28.10,0.00,0.00
1106,28.10,0.00,dy
1206,28.10-dy,0.00,0.00+dy
1008,37.50,0.00,0.00
1108,37.50,0.00,dy
1208,37.50-dy,0.00,0.00+dy
1308,37.50+dy,0.00,0.00+dy
1010,46.90,0.00,0.00
1110,46.90,0.00,dy
1210,46.90+dy,0.00,0.00+dy
1012,56.30,0.00,0.00
1112,56.30,0.00,dy
1212,56.30+dy,0.00,0.00+dy
1014,65.70,0.00,0.00
1114,65.70,0.00,dy
1214,65.70+dy,0.00,0.00+dy
1016,75.00,0.00,0.00 
2002,9.30,0.00,5.65
2102,9.30,0.00,5.65-dy
2202,9.30+dy,0.00,5.65-dy
2004,18.70,0.00,9.73
2104,18.70,0.00,9.73-dy
2204,18.70+dy,0.00,9.73-dy
2006,28.10,0.00,12.18
2106,28.10,0.00,12.18-dy
2206,28.10+dy,0.00,12.18-dy
2008,37.50,0.00,13.00
2108,37.50,0.00,13.00-dy
2010,46.90,0.00,12.18
2110,46.90,0.00,12.18-dy
2210,46.90-dy,0.00,12.18-dy
2012,56.30,0.00,9.73
2112,56.30,0.00,9.73-dy
2212,56.30-dy,0.00,9.73-dy
2014,65.70,0.00,5.65
2114,65.70,0.00,5.65-dy
2214,65.70-dy,0.00,5.65-dy
3000,0.00,5.00,0.00
3002,9.30,5.00,0.00
3102,9.30,5.00,dy
3004,18.70,5.00,0.00
3104,18.70,5.00,dy
3204,18.70-dy,5.00,0.00+dy
3006,28.10,5.00,0.00
3106,28.10,5.00,dy
3206,28.10-dy,5.00,0.00+dy
3008,37.50,5.00,0.00
3108,37.50,5.00,dy
3208,37.50-dy,5.00,0.00+dy
3308,37.50+dy,5.00,0.00+dy
3010,46.90,5.00,0.00
3110,46.90,5.00,dy
3210,46.90+dy,5.00,0.00+dy
3012,56.30,5.00,0.00
3112,56.30,5.00,dy
3212,56.30+dy,5.00,0.00+dy
3014,65.70,5.00,0.00
3114,65.70,5.00,dy
3214,65.70+dy,5.00,0.00+dy
3016,75.00,5.00,0.00
4002,9.30,5.00,5.65
4102,9.30,5.00,5.65-dy
4202,9.30+dy,5.00,5.65-dy
4004,18.70,5.00,9.73
4104,18.70,5.00,9.73-dy
4204,18.70-dy,5.00,9.73+dy
4006,28.10,5.00,12.18
4106,28.10,5.00,12.18-dy
4206,28.10-dy,5.00,12.18+dy
4008,37.50,5.00,13.00
4108,37.50,5.00,13.00-dy
4010,46.90,5.00,12.18
4110,46.90,5.00,12.18-dy
4210,46.90-dy,5.00,12.18-dy
4012,56.30,5.00,9.73
4112,56.30,5.00,9.73-dy
4212,56.30-dy,5.00,9.73-dy
4014,65.70,5.00,5.65     
4114,65.70,5.00,5.65-dy
4214,65.70-dy,5.00,5.65-dy 
2001,7.3,0,4.45
2003,11.3,0,6.52
2005,23.4,0,10.958
2007,32.8,0,12.592
2009,42.2,0,12.592
2011,51.6,0,10.958
2015,67.7,0,4.45
2013,63.7,0,6.52 
4001,7.3,5,4.45
4003,11.3,5,6.52   
4005,23.4,5,10.958
4007,32.8,5,12.592
4009,42.2,5,12.592
4011,51.6,5,10.958
4015,75-7.3,5,4.45
4013,75-11.3,5,6.52 
2504,18.7,2.5,9.733 
2506,28.1,2.5,12.183 
2508,37.5,2.5,13      
2510,46.9,2.5,12.183;    
2512,56.3,2.5,9.733  
2601,21.05,1.25,10.344
2602,21.05,3.75,10.344   
2603,53.95,1.25,10.344
2604,53.95,3.75,10.344 
1500,0,1.965,0
1502,9.3,1.965,0
1504,18.7,1.965,0
1506,28.1,1.965,0
1508,37.5,1.965,0
1510,46.9,1.965,0
1512,56.3,1.965,0
1514,65.7,1.965,0
1516,75,1.965,0
3500,0,3.035,0
3502,9.3,3.035,0
3504,18.7,3.035,0
3506,28.1,3.035,0
3508,37.5,3.035,0
3510,46.9,3.035,0
3512,56.3,3.035,0
3514,65.7,3.035,0
3516,75,3.035,0 
10000,0,0,-1
30000,0.00,5.00,-1
10160,75.00,0.00,-1
30160,75.00,5.00,-1
20000,-1,0,0
40000,-1,5,0
9999,37.5,10.5,10000
9998,37.5,10000,10.5];
% reference node
% Check the node coordinates as follows:
figure
plotnodes(Nodes);
% Element types -> {EltTypID EltName}
Types=  {1        'beam';
         2        'link'};
% type 1 
% /Upper chord:     
A_u1	=	0.056;			% m2 (upper chord)
Iy_u1	=	0.0031;	        % m4 (strong axis)
Iz_u1	=	0.00067;       	% m4 (weak axis)
wy_u1	=	0.440;	        % 
wz_u1	=	0.600;           %	
%SECTYPE,1,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY
A_u1b	=	0.060;			% m2 (upper chord)
Iy_u1b	=	0.00393	;        % m4 (strong axis)
Iz_u1b	=	0.00073;       	% m4 (weak axis)
%SECTYPE,101,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY :     
A_u2	=	0.05434	;		% m2 (upper chord)
Iy_u2	=	0.00293	;        % m4 (strong axis)
Iz_u2	=	0.000646 ;      	% m4 (weak axis)
wy_u2	=	0.440;	        % 
wz_u2	=	0.600 ;          %	
%SECTYPE,2,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY   
A_u3	=	0.03376	;		% m2 (upper chord)
Iy_u3	=	0.0019	;        % m4 (strong axis)
Iz_u3	=	0.00043 ;      	% m4 (weak axis)
wy_u3	=	0.440	;        % 
wz_u3	=	0.600   ;        %	
%SECTYPE,3,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY    
A_l1	=	0.0198;		% m2 (lower chord)
Iy_l1	=	0.000627;       % m4 (strong axis)
Iz_l1	=	0.000207;      	% m4 (weak axis)
wy_l1	=	0.520;      
wz_l1	=	0.420;       	
%SECTYPE,4,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY
A_v1	=	0.010;		% m2 (vertical)
Iy_v1	=	1.15E-04;       % m4 (strong axis, the same direction with global X)
Iz_v1	=	5.49E-05;    	% m4 (weak axis, the same direction with global Y)
wy_v1	=	0.320;	        % 
wz_v1	=	0.438;           %	
%SECTYPE,5,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY
 A_v2	=	0.02312	;	    % m2 (vertical)
Iy_v2	=	0.00065*1.2;         % m4 (strong axis, the same direction with global X)
Iz_v2	=	0.00016;    	    % m4 (weak axis, the same direction with global Y)
wy_v2	=	0.420;	        % 
wz_v2	=	0.472 ;          %	
%SECTYPE,6,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY    
 A_v3	=	0.01416;		    % m2 (vertical)
Iy_v3	=	0.000278;        % m4 (strong axis, the same direction with global X)
Iz_v3	=	0.000124;    	% m4 (weak axis, the same direction with global Y)
wy_v3	=	0.320;	        % 
wz_v3	=	0.438;           %	
%SECTYPE,7,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY
 A_d1	=	0.01416;		    % m2 (diagonal)
Iy_d1	=	0.000278;        % m4 (strong axis)
Iz_d1	=	0.000124;   	% m4 (weak axis, the same direction with global Y)
wy_d1	=	0.320	;        % 
wz_d1	=	0.438 ;          %	
%SECTYPE,8,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY    
 A_d2	=	0.0147;		    % m2 (diagonal)
Iy_d2	=	0.00034;         % m4 (strong axis)
Iz_d2	=	0.00012;    	    % m4 (weak axis, the same direction with global Y)
wy_d2	=	0.350;	        % 
wz_d2	=	0.438;           %	
%SECTYPE,9,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY    
 A_d3	=	0.0154;		    % m2 (diagonal)
Iy_d3	=	0.0004 ;         % m4 (strong axis)
Iz_d3	=	0.00012;    	    % m4 (weak axis, the same direction with global Y)
wy_d3	=	0.380	;        % 
wz_d3	=	0.438 ;          %	
%SECTYPE,10,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY  
 A_s1	=	0.02135	;	    % m2 (stringer)
Iy_s1	=	0.002  ;         % m4 (strong axis, global Y driection)
Iz_s1	=	0.00016 ;   	    % m4 (weak axis, the same direction with global Y)
wy_s1	=	0.250;	        % 
wz_s1	=	0.700 ;          % (re-check%)	
%SECTYPE,11,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY   
 A_c1	=	0.026044;		% m2 (cross beam)
Iy_c1	=	3.20E-03  ;       % m4 (strong axis, global X driection)
Iz_c1	=	9.25E-05;    	% m4 (weak axis, the same direction with global Z)
wy_c1	=	0.300	;        % 
wz_c1	=	0.900 ;          % (re-check%)	
%SECTYPE,12,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY  
 A_c2	=	0.025544;		% m2 (cross beam)
Iy_c2	=	0.00361 ;        % m4 (strong axis, global X driection)
Iz_c2	=	0.000203 ;   	% m4 (weak axis, the same direction with global Z)
wy_c2	=	0.400;	        % 
wz_c2	=	0.900 ;          % (re-check%)	
%SECTYPE,13,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY 
 A_t1	=	0.053 ;		    % m2 (cross beam)
Iy_t1	=	0.0028 ;         % m4 (strong axis, global X driection)
Iz_t1	=	0.000625;    	% m4 (weak axis, the same direction with global Z)
wy_t1	=	0.300;	        % 
wz_t1	=	0.300 ;          % (re-check%)	
%SECTYPE,14,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY   
 A_t2	=	0.01464	;	    % m2 (cross beam)
Iy_t2	=	0.00086  ;        % m4 (strong axis, global X driection)
Iz_t2	=	0.000092 ;   	% m4 (weak axis, the same direction with global Z)
wy_t2	=	0.300	 ;       % 
wz_t2	=	0.300 ;          % (re-check%)	
%SECTYPE,15,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY     
 A_t3	=	0.0358	;	    % m2 (cross beam)
Iy_t3	=	0.00212;          % m4 (strong axis, global X driection)
Iz_t3	=	0.000513 ;   	% m4 (weak axis, the same direction with global Z)
wy_t3	=	0.300;	        % 
wz_t3	=	0.300;           % (re-check%)	
%SECTYPE,16,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY    
 A_t4	=	0.03376	;	    % m2 (cross beam)
Iy_t4	=	0.0019 ;         % m4 (strong axis, global X driection)
Iz_t4	=	0.00043;    	    % m4 (weak axis, the same direction with global Z)
wy_t4	=	0.300;	        % 
wz_t4	=	0.300 ;          % (re-check%)	
%SECTYPE,17,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKE  
 A_lb1	=	0.0049;		% m2 (cross beam)
Iy_lb1 = 4.38E-06;
Iz_lb1 = 2.38E-05;
%SECTYPE,18,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY   
 A_ub1	=	0.0036;		% m2 (cross beam)
Iy_ub1 = 1.09E-05;
Iz_ub1 = 8.00E-06;
%SECTYPE,19,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY
 A_ub2	=	0.0019;	% m2 (cross beam)
Iy_ub2 = 1.40E-06;
Iz_ub2 = 1.90E-06;
%SECTYPE,20,BEAM, ASEC, , 0   %SECTYPE, SECID, Type, Subtype, Name, REFINEKEY
% Sections=[SecID A ky kz Ixx Iyy Izz yt yb zt zb]
Sections=[1 A_u1 Inf Inf 0 Iz_u1 Iy_u1 yt yb b/2 b/2;
            2 A_u2 Inf Inf 0 Iz_u2 Iy_u2 yt yb b/2 b/2;
            3 A_u3 Inf Inf 0 Iz_u3 Iy_u3 yt yb b/2 b/2;
            4 A_l1 Inf Inf 0 Iz_l1 Iy_l1 yt yb b/2 b/2;
            5 A_v1 Inf Inf 0 Iz_v1 Iy_v1 yt yb b/2 b/2;
            6 A_v2 Inf Inf 0 Iz_v2 Iy_v2 yt yb b/2 b/2;
            7 A_v3 Inf Inf 0 Iz_v3 Iy_v3 yt yb b/2 b/2;
            8 A_d1 Inf Inf 0 Iz_d1 Iy_d1 yt yb b/2 b/2;
            9 A_d2 Inf Inf 0 Iz_d2 Iy_d2 yt yb b/2 b/2;
           10 A_d3 Inf Inf 0 Iz_d3 Iy_d3 yt yb b/2 b/2;
           11 A_s1 Inf Inf 0 Iz_s1 Iy_s1 yt yb b/2 b/2;
           12 A_c1 Inf Inf 0 Iz_c1 Iy_c1 yt yb b/2 b/2;
           13 A_c2 Inf Inf 0 Iz_c2 Iy_c2 yt yb b/2 b/2;
           14 A_t1 Inf Inf 0 Iz_t1 Iy_t1 yt yb b/2 b/2;
           15 A_t2 Inf Inf 0 Iz_t2 Iy_t2 yt yb b/2 b/2;
           16 A_t3 Inf Inf 0 Iz_t3 Iy_t3 yt yb b/2 b/2;
           17 A_t4 Inf Inf 0 Iz_t4 Iy_t4 yt yb b/2 b/2;
           18 A_lb1 Inf Inf 0 Iz_lb1 Iy_lb1 yt yb b/2 b/2;
           19 A_ub1 Inf Inf 0 Iz_ub1 Iy_ub1 yt yb b/2 b/2;
           20 A_ub2 Inf Inf 0 Iz_ub2 Iy_ub2 yt yb b/2 b/2;
           21 A_u1b Inf Inf 0 Iz_u1b Iy_u1b yt yb b/2 b/2;
           22  Inf  Inf Inf Inf Inf Inf Inf Inf Inf Inf];            
% 2 pi*r^2 NaN NaN NaN NaN NaN NaN NaN NaN NaN];
% Materials=[MatID E nu];  
     Materials= [1 1.92e11 0.3 7850 Inf  
            2 1 1 1 k1        
            3 1 1 1 k2 
            4 1 1 1 k3
            5 1 1 1 k4
            6 1 1 1 k5
            7 1 1 1 k6
            8 1 1 1 k7]
% 2 210e6 0.3]; % other
% Elements=[EltID TypID SecID MatID n1 n2 n3]
Elements=[1000  1  4 1  1000  1002  9999
    1003    1   4  1 1002  1004  9999
    1006    1   4  1 1004  1006  9999
    1009    1   4  1 1006  1008  9999
    1012    1   4  1 1008  1010  9999
    1015    1   4  1 1010  1012  9999
    1018    1   4  1 1012  1014  9999
    1021    1   4  1 1014  1016  9999
    1502    2   22 2 1002  1102  NaN
    15020   1   5  1 1102  2102  9999
    15021   2   22 2 2102  2002  NaN
    1504    2   22 2 1004  1104  NaN
    15040   1   6  1 1104  2104  9999
    15041   2   22 2 2104  2004  NaN
    1506    2   22 2 1006  1106  NaN
    15060   1   7  1 1106  2106  9999
    15061   2   22 2 2106  2006  NaN
    1508    2   22 2 1008  1108  NaN
    15080   1   5  1 1108  2108  9998
    15081   2   22 2 2108  2008  NaN
    1510    2   22 2 1010  1110  NaN
    15100   1   7  1 1110  2110  9998
    15101   2   22 2 2110  2010  NaN
    1512    2   22 2 1012  1112  NaN
    15120   1   6  1 1112  2112  9998
    15121   2   22 2 2112  2012  NaN
    1514    2   22 2 1014  1114  NaN
    15140   1   5  1 1114  2114  9998
    15141   2   22 2 2114  2014  NaN
    2000    1   1  1 1000  2001  9999
    2001    1   21 1 2001  2002  9999
    2002    1   21 1 2002  2003  9999
    2003    1   2  1 2003  2004  9999
    2004    1   3  1 2004  2005  9999
    2005    1   3  1 2005  2006  9999
    2006    1   3  1 2006  2007  9999
    2007    1   3  1  2007  2008  9999
    2008    1   3  1 2008  2009  9999
    2009    1   3  1 2009  2010  9999
    2010    1   3  1 2010  2011  9999
    2011    1   3  1 2011  2012  9999
    2012    1   2  1 2012  2013  9999
    2013    1   21 1 2013  2014  9999
    2014    1   21  1 2014  2015  9999
    2015    1   1  1 2015  1016  9999
    2502    2   22 2 1004  1204  NaN
    25020   1   8  1 1204  2202  9998
    25021   2   22 2 2202  2002  NaN
    2504    2   22 2 1006  1206  NaN
    25040   1   9  1 1206  2204  9998
    25041   2   22 2 2204  2004  NaN
    2506    2   22 2  1008  1208  NaN
    25060   1   10 1  1208  2206  9998
    25061   2   22 2  2206  2006  NaN
    2508    2   22 2  1008  1308  NaN
    25080   1   10 1 1308  2210  9998
    25081   2   22 2  2210  2010  NaN
    2510    2   22  2 1010  1210  NaN
    25100   1   9  1 1210  2212  9998
    25101   2   22 2 2212  2012  NaN
    2512    2   22 2 1012  1212  NaN
    25120   1   8  1 1212  2214  9998
    25121   2   22 2 2214  2014  NaN
    3000    1   4  1 3000  3002  9999
    3003    1   4  1 3002  3004  9999
    3006    1   4  1 3004  3006  9999
    3009    1   4  1 3006  3008  9999
    3012    1   4  1 3008  3010  9999
    3015    1   4  1 3010  3012  9999
    3018    1   4  1 3012  3014  9999
    3021    1   4  1 3014  3016  9999
    3502    2   22 2 3002  3102  NaN
    35020   1   5  1 3102  4102  9998
    35021   2   22 2 4102  4002  NaN
    3504    2   22 2 3004  3104  NaN
    35040   1   6  1 3104  4104  9998
    35041   2   22 2 4104  4004  NaN
    3506    2   22 2 3006  3106  NaN
    35060   1   7  1 3106  4106  9998
    35061   2   22 2 4106  4006  NaN
    3508    2   22 2 3008  3108  NaN
    35080   1   5  1 3108  4108  9998
    35081   2   22 2 4108  4008  NaN
    3510    2   22 2 3010  3110  NaN
    35100   1   7  1 3110  4110  9998
    35101   2   22 2 4110  4010  NaN
    3512    2   22 2 3012  3112  NaN
    35120   1   6  1 3112  4112  9998
    35121   2   22 2 4112  4012  NaN
    3514    2   22 2 3014  3114  NaN
    35140   1   5  1 3114  4114  9998
    35141   2   22 2 4114  4014  NaN
    4000    1   1  1 3000  4001  9999
    4001    1   21 1 4001  4002  9999
    4002    1   21 1 4002  4003  9999
    4003    1   2  1 4003  4004  9999
    4004    1   3  1 4004  4005  9999
    4005    1   3  1 4005  4006  9999
    4006    1   3  1 4006  4007  9999
    4007    1   3  1 4007  4008  9999
    4008    1   3  1 4008  4009  9999
    4009    1   3  1 4009  4010  9999
    4010    1   3  1 4010  4011  9999
    4011    1   3  1 4011  4012  9999
    4012    1   2  1 4012  4013  9999
    4013    1   21 1 4013  4014  9999
    4014    1   21 1 4014  4015  9999
    4015    1   1  1 4015  3016  9999
    4502    2   22 2 3004  3204  NaN
    45020   1   8  1 3204  4202  9998
    45021   2   22  2 4202  4002  NaN
    4504    2   22  2 3006  3206  NaN
    45040   1   9  1 3206 4204  9998
    45041   2   22 2 4204  4004  NaN
    4506    2   22 2 3008  3208  NaN
    45060   1   10 1 3208  4206  9998
    45061   2   22 2 4206  4006  NaN
    4508    2   22 2 3008  3308  NaN
    45080   1   10 1 3308  4210  9998
    45081   2   22 2 4210  4010  NaN
    4510    2   22 2 3010  3210  NaN
    45100   1   9  1 3210  4212  9998
    45101   2   22 2 4212  4012  NaN
    4512    2   22 2 3012  3212  NaN
    45120   1   8  1 3212  4214  9998
    45121   2   22 2 4214  4014  NaN
    5000    1   12 1 1000  1500  9999
    5002    1   13 1 1002  1502  9999
    5004    1   13 1 1004  1504  9999
    5006    1   13 1 1006  1506  9999
    5008    1   13 1 1008  1508  9999
    5010    1   13 1 1010  1510  9999
    5012    1   13 1 1012  1512  9999
    5014    1   13 1 1014  1514  9999
    5016    1   12 1 1016  1516  9999
    5100    1   12 1 1500  3500  9999
    5102    1   13 1 1502  3502  9999
    5104    1   13 1 1504  3504  9999
    5106    1   13 1 1506  3506  9999
    5108    1   13 1 1508  3508  9999
    5110    1   13 1 1510  3510  9999
    5112    1   13 1 1512  3512  9999
    5114    1   13 1 1514  3514  9999
    5116    1   12 1 1516  3516  9999
    5200    1   12 1 3500  3000  9999
    5202    1   13 1 3502  3002  9999
    5204    1   13 1 3504  3004  9999
    5206    1   13 1 3506  3006  9999
    5208    1   13 1 3508  3008  9999
    5210    1   13 1 3510  3010  9999
    5212    1   13 1 3512  3012  9999
    5214    1   13 1 3514  3014  9999
    5216    1   12 1 3516  3016  9999
    6000    1   11 1 1500  1502  9999
    6002    1   11 1 1502  1504  9999
    6004    1   11 1 1504  1506  9999
    6006    1   11 1 1506  1508  9999
    6008    1   11 1 1508  1510  9999
    6010    1   11 1 1510  1512  9999
    6012    1   11 1 1512  1514  9999
    6014    1   11 1 1514  1516  9999
    6100    1   11 1 3500  3502  9999
    6102    1   11 1 3502  3504  9999
    6104    1   11 1 3504  3506  9999
    6106    1   11 1 3506  3508  9999
    6108    1   11 1 3508  3510  9999
    6110    1   11 1 3510  3512  9999
    6112    1   11 1 3512  3514  9999
    6114    1   11 1 3514  3516  9999
    6200    1   18 1 1000  3002  9999
    6201    1   18 1 3000  1002  9999
    6202    1   18 1 1002  3004  9999
    6203    1   18 1 3002  1004  9999
    6204    1   18 1 1004  3006  9999
    6205    1   18 1 3004  1006  9999
    6206    1   18 1 1006  3008  9999
    6207    1   18 1 3006  1008  9999
    6208    1   18 1 1008  3010  9999
    6209    1   18 1 3008  1010  9999
    6210    1   18 1 1010  3012  9999
    6211    1   18 1 3010  1012  9999
    6212    1   18 1 1012  3014  9999
    6213    1   18 1 3012  1014  9999
    6214    1   18 1 1014  3016  9999
    6215    1   18 1 3014  1016  9999
    7004    1   14 1 2004  2504  9999
    7006    1   15 1 2006  2506  9999
    7008    1   16 1 2008  2508  9999
    7010    1   15 1 2010  2510  9999
    7012    1   14 1 2012  2512  9999
    7104    1   14 1 2504  4004  9999
    7106    1   15 1 2506  4006  9999
    7108    1   16 1 2508  4008  9999
    7110    1   15 1 2510  4010  9999
    7112    1   14 1 2512  4012  9999
    7204    1   19 1 2601  2005  9999
    7205    1   19 1 2005  2506  9999
    7206    1   19 1 2007  2506  9999
    7207    1   19 1 2007  2508  9999
    7208    1   19 1 2009  2508  9999
    7209    1   19 1 2009  2510  9999
    7210    1   19 1 2011  2510  9999
    7211    1   19 1 2011  2603  9999
    7304    1   19 1 2602  4005  9999
    7305    1   19 1 4005  2506  9999
    7306    1   19 1 4007  2506  9999
    7307    1   19 1 4007  2508  9999
    7308    1   19 1 4009  2508  9999
    7309    1   19 1 4009  2510  9999
    7310    1   19 1 4011  2510  9999
    7311    1   19 1 2604  4011  9999
    7401    1   20 1 2004  2601  9999
    7402    1   19 1 2504  2601  9999
    7403    1   19 1 2504  2602  9999
    7404    1   20 1 2602  4004  9999
    7405    1   20 1 2601  2602  9999
    7411    1   20 1 2012  2603  9999
    7412    1   19 1 2603  2512  9999
    7413    1   19 1 2512  2604  9999
    7414    1   20 1 2604  4012  9999
    7415    1   20 1 2603  2604  9999
    10000   2   22 3 1000  10000  NaN
    30000   2   22 4 3000  30000  NaN
    10160   2   22 5 1016  10160  NaN
    30160   2   22 6 3016  30160  NaN
    20000   2   22 7 1000  20000  NaN
    40000   2   22 8 3000  40000  NaN];
% Check node and element definitions as follows:
hold('on');
plotelem(Nodes,Elements,Types);
title('Nodes and elements');
% Degrees of freedom
% Assemble a column matrix containing all DOFs at which stiffness is
% present in the model:
DOF=getdof(Elements,Types);
%DOF=dof_truss(NodeNum);
% Remove all DOFs equal to zero from the vector:
% - 3D analysis: 
% - Fixed at node 1
% - Roller at at node 11
%seldof=[0.04;0.05;0.06;1000.01;1000.02;1000.03;1016.02;1016.03;3000.01;3000.02;3016.02;1016.03;3000.03;3016.03;1000.03;10000.01;10000.02;10000.03;20000.01;20000.02;20000.03;40000.01;40000.02;40000.03;10160.01
    %10160.02;10160.03;30000.01;30000.02;30000.03;30160.01;30160.02;30160.03];
    
seldof=[10000.01;
 10000.02;
    10000.03;
    10000.04
    10000.05
    10000.06
    20000.01;
    20000.02;
    20000.03;
    20000.04
    20000.05
    20000.06
    40000.01;
    40000.02;
    40000.03;
    40000.04
    40000.05
    40000.06
    10160.01
    10160.02;
    10160.03;
    10160.04
    10160.05
    10160.06
     30000.01;
    30000.02;
    30000.03
    30000.04
    30000.05
    30000.06
    30160.01;
      30160.02;
      30160.03
      30160.04
      30160.05
      30160.06
      1000.01;
    1000.02;
    %1000.03;
    1016.02;
    %1016.03;
     3000.01;
    3000.02;
    3016.02;
1102.04
1104.04
1204.04
1106.04
1206.04
1108.04
1208.04
1308.04
1110.04
1210.04
1112.04
1212.04
1114.04
1214.04
2102.04
2202.04
2104.04
2204.04
2106.04
2206.04
2108.04
2110.04
2210.04
2112.04
2212.04
2114.04
2214.04
3102.04
3104.04
3204.04
3106.04
3206.04
3108.04
3208.04
3308.04
3110.04
3210.04
3112.04
3212.04
3114.04
3214.04
4102.04
4202.04
4104.04
4204.04
4106.04
4206.04
4108.04
4110.04
4210.04
4112.04
4212.04
4114.04
4214.04
1102.05
1104.05
1204.05
1106.05
1206.05
1108.05
1208.05
1308.05
1110.05
1210.05
1112.05
1212.05
1114.05
1214.05
2102.05
2202.05
2104.05
2204.05
2106.05
2206.05
2108.05
2110.05
2210.05
2112.05
2212.05
2114.05
2214.05
3102.05
3104.05
3204.05
3106.05
3206.05
3108.05
3208.05
3308.05
3110.05
3210.05
3112.05
3212.05
3114.05
3214.05
4102.05
4202.05
4104.05
4204.05
4106.05
4206.05
4108.05
4110.05
4210.05
4112.05
4212.05
4114.05
4214.05
1102.06
1104.06
1204.06
1106.06
1206.06
1108.06
1208.06
1308.06
1110.06
1210.06
1112.06
1212.06
1114.06
1214.06
2102.06
2202.06
2104.06
2204.06
2106.06
2206.06
2108.06
2110.06
2210.06
2112.06
2212.06
2114.06
2214.06
3102.06
3104.06
3204.06
3106.06
3206.06
3108.06
3208.06
3308.06
3110.06
3210.06
3112.06
3212.06
3114.06
3214.06
4102.06
4202.06
4104.06
4204.06
4106.06
4206.06
4108.06
4110.06
4210.06
4112.06
4212.06
4114.06
4214.06
1002.04;
    1004.04;
    1006.04;
    1008.04;
    1010.04;
    1012.04;
    1014.04;
    2002.04;
    2004.04;
    2006.04;
    2008.04;
    2010.04;
    2012.04;
    2014.04;
    3002.04;
    3004.04;
    3006.04;
    3008.04;
3010.04;
3012.04;
3014.04;
4002.04;
4004.04;
4006.04;
4008.04;
4010.04;
4012.04;
4014.04;
2001.04;
2003.04;
2005.04;
2007.04;
2009.04;
2011.04;
2015.04;
2013.04;
4001.04;
4003.04;
4005.04;
4007.04;
4009.04;
4011.04;
4015.04;
4013.04;
2504.04;
2506.04;
2508.04;
2510.04;
2512.04;
2601.04;
2602.04;
2603.04;
2604.04;

1500.04;
1502.04;
1504.04;
1506.04;
1508.04;
1510.04;
1512.04;
1514.04;
1516.04;
3500.04;
3502.04;
3504.04;
3506.04;
3508.04;
3510.04;
3512.04;
3514.04;
3516.04

1002.05;
    1004.05;
    1006.05;
    1008.05;
    1010.05;
    1012.05;
    1014.05;
    2002.05;
    2004.05;
    2006.05;
    2008.05;
    2010.05;
    2012.05;
    2014.05;
    3002.05;
    3004.05;
    3006.05;
    3008.05;
3010.05;
3012.05;
3014.05;
4002.05;
4004.05;
4006.05;
4008.05;
4010.05;
4012.05;
4014.05;
2001.05;
2003.05;
2005.05;
2007.05;
2009.05;
2011.05;
2015.05;
2013.05;
4001.05;
4003.05;
4005.05;
4007.05;
4009.05;
4011.05;
4015.05;
4013.05;
2504.05;
2506.05;
2508.05;
2510.05;
2512.05;
2601.05;
2602.05;
2603.05;
2604.05;

1500.05;
1502.05;
1504.05;
1506.05;
1508.05;
1510.05;
1512.05;
1514.05;
1516.05;
3500.05;
3502.05;
3504.05;
3506.05;
3508.05;
3510.05;
3512.05;
3514.05;
3516.05

1002.06;
    1004.06;
    1006.06;
    1008.06;
    1010.06;
    1012.06;
    1014.06;
    2002.06;
    2004.06;
    2006.06;
    2008.06;
    2010.06;
    2012.06;
    2014.06;
    3002.06;
    3004.06;
    3006.06;
    3008.06;
3010.06;
3012.06;
3014.06;
4002.06;
4004.06;
4006.06;
4008.06;
4010.06;
4012.06;
4014.06;
2001.06;
2003.06;
2005.06;
2007.06;
2009.06;
2011.06;
2015.06;
2013.06;
4001.06;
4003.06;
4005.06;
4007.06;
4009.06;
4011.06;
4015.06;
4013.06;
2504.06;
2506.06;
2508.06;
2510.06;
2512.06;
2601.06;
2602.06;
2603.06;
2604.06;

% 1500.06;
% 1502.06;
% 1504.06;
% 1506.06;
% 1508.06;
% 1510.06;
% 1512.06;
% 1514.06;
% 1516.06;
% 3500.06;
% 3502.06;
% 3504.06;
% 3506.06;
% 3508.06;
% 3510.06;
% 3512.06;
% 3514.06;
% 3516.06

1102.02
1104.02
1204.02
1106.02
1206.02
1108.02
1208.02
1308.02
1110.02
1210.02
1112.02
1212.02
1114.02
1214.02
2102.02
2202.02
2104.02
2204.02
2106.02
2206.02
2108.02
2110.02
2210.02
2112.02
2212.02
2114.02
2214.02
3102.02
3104.02
3204.02
3106.02
3206.02
3108.02
3208.02
3308.02
3110.02
3210.02
3112.02
3212.02
3114.02
3214.02
4102.02
4202.02
4104.02
4204.02
4106.02
4206.02
4108.02
4110.02
4210.02
4112.02
4212.02
4114.02
4214.02

1102.01
1104.01
1204.01
1106.01
1206.01
1108.01
1208.01
1308.01
1110.01
1210.01
1112.01
1212.01
1114.01
1214.01
2102.01
2202.01
2104.01
2204.01
2106.01
2206.01
2108.01
2110.01
2210.01
2112.01
2212.01
2114.01
2214.01
3102.01
3104.01
3204.01
3106.01
3206.01
3108.01
3208.01
3308.01
3110.01
3210.01
3112.01
3212.01
3114.01
3214.01
4102.01
4202.01
4104.01
4204.01
4106.01
4206.01
4108.01
4110.01
4210.01
4112.01
4212.01
4114.01
4214.01

1102.03
1104.03
1204.03
1106.03
1206.03
1108.03
1208.03
1308.03
1110.03
1210.03
1112.03
1212.03
1114.03
1214.03
2102.03
2202.03
2104.03
2204.03
2106.03
2206.03
2108.03
2110.03
2210.03
2112.03
2212.03
2114.03
2214.03
3102.03
3104.03
3204.03
3106.03
3206.03
3108.03
3208.03
3308.03
3110.03
3210.03
3112.03
3212.03
3114.03
3214.03
4102.03
4202.03
4104.03
4204.03
4106.03
4206.03
4108.03
4110.03
4210.03
4112.03
4212.03
4114.03
4214.03];

%}
DOF=removedof(DOF,seldof);
% Assembly of stiffness matrix K
[K,M]=asmkm(Nodes,Elements,Types,Sections,Materials,DOF);
% bvib manual
% Tutorial: dynamic analysis: eigenvalue problem
% Units: m, N
% Assembly of M and K
% Eigenvalue problem
nMode=30;
[phi,omega]=eigfem(K,M,nMode);
% Display eigenfrequenties
disp('Lowest eigenfrequencies [Hz]');
a=omega/2/pi
idx=[2 3 4 5 9 11 12 13 14 15];
fre_FEM=a(idx)
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,1))
% title('Eigenmode 1')

% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,2))
% title('Eigenmode 2')
% 
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,3))
% title('Eigenmode 3')
% 
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,4))
% title('Eigenmode 4')
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,5))
% title('Eigenmode 5')
% % 
% % figure;
% % animdisp(Nodes,Elements,Types,DOF,phi(:,6))
% % title('Eigenmode 6')
% 
% % figure;
% % animdisp(Nodes,Elements,Types,DOF,phi(:,7))
% % title('Eigenmode 7')
% % 
% % figure;
% % animdisp(Nodes,Elements,Types,DOF,phi(:,8))
% % title('Eigenmode 8')
% 
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,9))
% title('Eigenmode 9')
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,10))
% title('Eigenmode 10')
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,11))
% title('Eigenmode 11')
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,12))
% title('Eigenmode 12')
% fre_FEM=a(idx)
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,13))
% title('Eigenmode 13')
% 
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,14))
% title('Eigenmode 14')
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,15))
% title('Eigenmode 15')
% % figure;
% % animdisp(Nodes,Elements,Types,DOF,phi(:,16))
% % title('Eigenmode 16')
% % figure;
% % animdisp(Nodes,Elements,Types,DOF,phi(:,17))
% % title('Eigenmode 17')
% 
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,18))
% title('Eigenmode 18')
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,19))
% title('Eigenmode 19')
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,20))
% title('Eigenmode 20')
% 
% animdisp(Nodes,Elements,Types,DOF,phi(:,21))
% title('Eigenmode 21')
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,22))
% title('Eigenmode 22')
% figure;
% animdisp(Nodes,Elements,Types,DOF,phi(:,23))
% title('Eigenmode 23')

